{
    "$id": "http://json-schema.org/draft-06/schema#",
    "$schema": "http://json-schema.org/draft-06/schema#",
    "definitions": {
        "Project": {
            "type": "object",
            "title": "Project",
            "properties": {
                "name": {
                    "type": "string",
                    "title": "Name",
                    "default": ""
                },
                "slug": {
                    "type": "string",
                    "title": "Slug",
                    "default": ""
                },
                "municipality": {
                    "type": "string",
                    "title": "Municipality",
                    "default": ""
                },
                "region": {
                    "type": "string",
                    "title": "Region",
                    "default": ""
                },
                "client": {
                    "type": "string",
                    "title": "Client",
                    "default": ""
                },
                "power": {
                    "type": "string",
                    "title": "Power",
                    "default": ""
                },
                "hasCDU": {
                    "type": "boolean",
                    "title": "CDU provided",
                    "default": false
                },
                "hasUsiCivici": {
                    "type": "boolean",
                    "title": "Usi civici certificate provided",
                    "default": false
                },
                "parties": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/Party"
                    }
                },
                "lands": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/Land"
                    }
                },
                "registrations": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/Registration"
                    }
                },
                "constraints": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/Constraint"
                    }
                }
            }
        },
        "Company": {
            "type": "object",
            "title": "Company",
            "properties": {
                "companyType": {
                    "type": "string",
                    "enum": ["Società a responsabilità limitata", "Società a responsabilità limitata a socio unico", "Società per Azioni"]
                },
                "name": {
                    "type": "string",
                    "title": "Name"
                },
                "slug": {
                    "type": "string",
                    "title": "Slug"
                },
                "registeredSeat": {
                    "$ref": "#/definitions/Address"
                },
                "VAT": {
                    "type": "string",
                    "title": "VAT"
                },
                "REA": {
                    "type": "string",
                    "title": "REA"
                },
                "capital": {
                    "type": "string",
                    "title": "Share Capital"
                }
            }
        },
        "Notary": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string",
                    "title": "name",
                    "default": ""
                },
                "seat": {
                    "type": "string",
                    "title": "seat",
                    "default": ""
                }
            }
        },
        "Person": {
            "type": "object",
            "properties": {
                "name": {
                    "type": "string",
                    "title": "name"
                },
                "gender": {
                    "type": "string",
                    "title": "gender"
                },
                "birthdate": {
                    "type": "string",
                    "title": "birthdate"
                },
                "birthplace": {
                    "type": "string",
                    "title": "birthplace"
                },
                "birthprovince": {
                    "type": "string",
                    "title": "birthprovince"
                },
                "taxcode": {
                    "type": "string",
                    "title": "Tax Code"
                },
                "recidency": {
                    "$ref": "#/definitions/Address"
                },
                "Personal ID": {
                    "$ref": "#/definitions/IDDocument"
                }
            }
        },
        "PoA": {
            "type": "object",
            "title": "Power of Attorney",
            "properties": {
                "description": {
                    "type": "string",
                    "title": "Description",
                    "default": "procura speciale"
                },
                "issuer": {
                    "$ref": "#/definitions/Person"
                },
                "quality": {
                    "type": "string",
                    "title": "Quality",
                    "enum": ["in nome proprio", "procuratore speciale", "Amministratore Unico", "Amministratore Delegato"]
                },
                "poa": {
                    "$ref": "#/definitions/PoA",
                    "depends": "this.quality === 'procuratore speciale'"
                },
                "company": {
                    "$ref": "#/definitions/Company",
                    "depends": "~this.quality.indexOf('Amministratore')"
                },
                "deed": {
                    "$ref": "#/definitions/NotarialDeed"
                },
                "attachment": {
                    "type": "string",
                    "title": "Attachment"
                },
                "slug": {
                    "type": "string",
                    "title": "Slug",
                    "default": ""
                }
            }
        },
        "IDDocument": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "enum": ["Carta di Identità", "Passaporto"]
                },
                "number": {
                    "type": "string",
                    "title": "Document"
                },
                "issuer": {
                    "type": "string",
                    "title": "Issued by"
                },
                "issueDate": {
                    "type": "string",
                    "title": "Issued on"
                },
                "expiration": {
                    "type": "string",
                    "title": "Valid Until"
                }                
            }
        },
        "Address": {
            "type": "object",
            "properties": {
                "address": {
                    "type": "string",
                    "title": "Address"
                },
                "city": {
                    "type": "string",
                    "title": "City"
                }
            }
        },
        "Party": {
            "type": "object",
            "title": "Party",
            "properties": {
                "role": {
                    "type": "string",
                    "title": "Role",
                    "enum": ["grantor", "grantee"]
                },
                "name": {
                    "type": "string",
                    "title": "Name"
                },
                "info": {
                    "$ref": "#/definitions/Person"
                },
                "quality": {
                    "type": "string",
                    "title": "Quality",
                    "enum": ["in nome proprio", "procuratore speciale", "Amministratore Unico", "Amministratore Delegato"]
                },
                "poa": {
                    "$ref": "#/definitions/PoA",
                    "depends": "this.quality === 'procuratore speciale'"
                },
                "company": {
                    "$ref": "#/definitions/Company",
                    "depends": "~this.quality.indexOf('Amministratore')"
                }
            }
        },
        "Registration": {
            "type": "object",
            "properties": {
                "title": {
                    "type": "string"
                },
                "lands": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "$data": "../../../lands"
                    }
                },
                "deed": {
                    "$ref": "#/definitions/NotarialDeed"
                }
            }
        },
        "Constraint": {
            "type": "object",
            "properties": {
                "title": {
                    "type": "string"
                },
                "description": {
                    "type": "string"
                },
                "lands": {
                    "type": "array",
                    "items": {
                        "type": "string",
                        "$data": "../../../lands"
                    }
                }
            }
        },
        "Land": {
            "type": "object",
            "title": "Land",
            "properties": {
                "name": {
                    "type": "string",
                    "title": "name"
                },                
                "sheet": {
                    "type": "string",
                    "title": "sheet"
                },                
                "parcel": {
                    "type": "string",
                    "title": "parcel"
                },                
                "municipality": {
                    "type": "string",
                    "title": "municipality"
                },                
                "area": {
                    "type": "string",
                    "title": "area"
                },                
                "quality": {
                    "type": "string",
                    "title": "quality"
                },                
                "classe": {
                    "type": "string",
                    "title": "classe"
                },                
                "rd": {
                    "type": "string",
                    "title": "R.D.EURO"
                },                
                "ra": {
                    "type": "string",
                    "title": "R.A.EURO"
                },                
                "holders": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "title": "holder",
                        "properties": {
                            "name": {
                                "type": "string",
                                "$data": "../../../../../parties"
                            },
                            "quota": {
                                "type": "string"
                            },
                            "ownershipType": {
                                "type": "string",
                                "enum": ["property", "enfiteusi", "usucapione", "other"],
                                "default": "property"
                            },
                            "ownershipOrigin": {
                                "type": "string",
                                "enum": ["purchase", "donation", "lawful succession", "testament succession"],
                                "depends": "this.ownershipType == 'property'",
                                "default": "purchase"                                
                            },
                            "ownershipTitle": {
                                "$ref": "#/definitions/NotarialDeed",
                                "depends": "this.ownershipType != 'usucapione'"
                            },
                            "primaryOwner": {
                                "type": "string",
                                "title": "Primary Ownership",
                                "depends": "this.ownershipType == 'enfiteusi'"
                            },            
                            "hasAgevolazioniPPC": {
                                "type": "boolean",
                                "title": "Has Agevolazioni PPC",
                                "depends": "this.ownershipType == 'property'"
                            },
                            "hasSubsidies": {
                                "type": "boolean",
                                "title": "Has obtained subsidies"
                            },
                            "titleChallengeableWithin": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "RegistrationInfo": {
            "type": "object",
            "properties": {
                "seat": {
                    "$ref": "#/definitions/Address"
                },
                "date": {
                    "type": "string"
                },
                "number": {
                    "type": "string"
                }
            }
        },
        "NotarialDeed": {
            "type": "object",
            "properties": {
                "date": {
                    "type": "string"
                },
                "notary": {
                    "$ref": "#/definitions/Notary"
                },
                "repertorio": {
                    "type": "string"
                },
                "raccolta": {
                    "type": "string"
                },
                "registrationInfo": {
                    "$ref": "#/definitions/RegistrationInfo"
                }
            }
        }
    },
    "type": "object",
    "title": "Root",
    "properties": {
        "projects": {
            "type": "array",
            "title": "Projects",
            "items": {
                "$ref": "#/definitions/Project"
            }
        }
    }
}